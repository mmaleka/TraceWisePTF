<!-- CSS -->
<link rel="stylesheet" href="/static/css/inspection.css" />
<link href="https://cdn.jsdelivr.net/npm/handsontable@12.1.0/dist/handsontable.full.min.css" rel="stylesheet">

<!-- Add Button -->
<div class="row mb-3">
  <div class="col-12 text-end">
    <button class="btn btn-success" id="openFormPanelBtn" >âž• Add Component</button>
    <button class="btn btn-primary me-2" id="saveChangesBtn" >âœ… Save Changes</button>
    <button class="btn btn-outline-secondary" id="downloadExcelBtn" >ðŸ“¤ Export Excel</button>
  </div>
</div>


<!-- Slide-in UT Form (initially hidden) -->
<div id="utFormPanel" class="ut-slide-panel">
  <div class="panel-content p-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h5 class="text-primary m-0">âœ… Final Inspection Entry</h5>
      <button class="btn btn-sm btn-outline-danger" id="closeFormPanelBtn" >âœ–</button>
    </div>
     
<!--     <form id="utForm"> -->
    <form id="inspectionForm" onsubmit="handleFormSubmit(event)">
      
      <div class="mb-3">
        <label for="serialNumber" class="form-label">Shell Serial Number</label>
    <input type="text" class="form-control" id="shell-number" required />
      </div>

      <div class="mb-3">
        <label for="castCode" class="form-label">Cast Code</label>
    <input type="text" class="form-control" id="cast-code" required />
      </div>

      <div class="mb-3">
        <div class="mb-3">
    <label for="heatCode" class="form-label">Heat Code</label>
    <input type="text" class="form-control" id="heat-code" required />
  </div>
      </div>
      <div class="form-check mb-3">
        <input class="form-check-input" type="checkbox" id="allowDuplicate">
        <label class="form-check-label" for="allowDuplicate">
          Log duplicate Shells
        </label>
      </div>
      <div class="d-grid gap-2">
        <button type="submit" class="btn btn-primary">ðŸ“¥ Submit Entry</button>
      </div>

      <div id="cncMessage" class="text-center mt-3 fw-bold"></div>
    </form>
  </div>
</div>


<div class="row mt-4 justify-content-center">
  <div class="col-md-6">
    <div class="card shadow-sm">
      <div class="card-body text-center">
        <h4 id="productTitle" class="text-center text-secondary mb-4">
          âœ… M0121 Body Final Inspection Results
        </h4>
        
        <div class="d-flex justify-content-center align-items-center gap-2">
          <label for="productToggle" class="form-label m-0">Select Product:</label>
          <select class="form-select text-center text-secondary w-auto" id="productToggle" onchange="switchProduct()">
            <option value="M0121 Body">M0121 Body</option>
            <option value="M2003 Body">M2003 Body</option>
            <option value="M2003 Ogive">M2003 Ogive</option>
            <option value="Pump">Pump</option>
          </select>
        </div>

      </div>
    </div>
  </div>
</div>




<div id="spreadsheet-container">
  <div id="spreadsheet"></div>
</div>


